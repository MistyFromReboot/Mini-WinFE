[main]
Title=Shell
Description=Select a shell.
Selected=True
Locked=True
Mandatory=True
Level=3
Author=Misty
Version=20220618
Date=2022-06-18
Interface=Interface1

[Interface1]
pTextLabel_TAB_A="BBLean",1,1,15,4,80,18,10,Bold
pButton_TAB_B="CMD",1,8,85,0,80,25,Change.To.Tab.B,0,True,_Change.To.Tab.B,True
pButton_TAB_C="WinXShell",1,8,165,0,80,25,Change.To.Tab.C,0,True,_Change.To.Tab.C,True
pButton_TAB_D="LaunchBar",1,8,245,0,80,25,Change.To.Tab.D,0,True,_Change.To.Tab.D,True
pButton_TAB_E="?",1,8,325,0,80,25,Change.To.Tab.E,0,True,_Change.To.Tab.E,True
pBevel_A1=,1,12,10,70,500,40
pScrollBox_A1=BBLean,1,4,20,80,100,20,BBLean
pTextLabel_A1=Current Shell,1,1,220,80,222,18,10,Bold
pButton_A1=HELP,1,8,430,80,70,20,HELPShell2,0,True,_HELPShell2_,True
pBevel_bblean2=,1,12,10,120,500,40
pScrollBox_bblean2=NO,1,4,20,130,100,20,YES,NO
pTextLabel_bblean2="Skin Windows",1,1,219,131,129,18,10,Bold
pButton_bblean2=HELP,1,8,430,130,70,20,HELPBBLean2,0,True

[Interface2]
pButton_TAB_A="BBLean",1,8,5,0,80,25,Change.To.Tab.A,0,True,_Change.To.Tab.A,True
pTextLabel_TAB_B="CMD",1,1,110,4,80,18,10,Bold
pButton_TAB_C="WinXShell",1,8,165,0,80,25,Change.To.Tab.C,0,True,_Change.To.Tab.C,True
pButton_TAB_D="LaunchBar",1,8,245,0,80,25,Change.To.Tab.D,0,True,_Change.To.Tab.D,True
pButton_TAB_E="?",1,8,325,0,80,25,Change.To.Tab.E,0,True,_Change.To.Tab.E,True
pBevel_A1=,1,12,10,70,500,40
pScrollBox_A1=CMD,1,4,20,80,100,20,CMD
pTextLabel_A1=Current Shell,1,1,220,80,222,18,10,Bold
pButton_A1=HELP,1,8,430,80,70,20,HELPShell2,0,True,_HELPShell2_,True

[Interface3]
pButton_TAB_A="BBLean",1,8,5,0,80,25,Change.To.Tab.A,0,True,_Change.To.Tab.A,True
pButton_TAB_B="CMD",1,8,85,0,80,25,Change.To.Tab.B,0,True,_Change.To.Tab.B,True
pTextLabel_TAB_C="WinXShell",1,1,175,4,80,18,10,Bold
pButton_TAB_D="LaunchBar",1,8,245,0,80,25,Change.To.Tab.D,0,True,_Change.To.Tab.D,True
pButton_TAB_E="?",1,8,325,0,80,25,Change.To.Tab.E,0,True,_Change.To.Tab.E,True
pBevel_A1=,1,12,10,70,500,40
pScrollBox_A1=WinXShell,1,4,20,80,100,20,WinXShell
pTextLabel_A1=Current Shell,1,1,220,80,222,18,10,Bold
pButton_A1=HELP,1,8,430,80,70,20,HELPShell2,0,True,_HELPShell2_,True
pBevel_WinXShell2=,1,12,10,120,500,40
pScrollBox_WinXShell2=YES,1,4,20,130,100,20,YES,NO
pTextLabel_WinXShell2="Desktop Icons",1,1,215,131,133,18,10,Bold
pButton_WinXShell2=HELP,1,8,430,130,70,20,HELPWinXShell2,0,True
pBevel_WinXShell3=,1,12,10,170,500,40
pScrollBox_WinXShell3=YES,1,4,20,180,100,20,YES,NO
pTextLabel_WinXShell3="Start Menu Icons",1,1,205,181,150,18,10,Bold
pButton_WinXShell3=HELP,1,8,430,180,70,20,HELPWinXShell3,0,True
pBevel_WinXShell4=,1,12,10,220,500,40
pScrollBox_WinXShell4=YES,1,4,20,230,100,20,YES,NO
pTextLabel_WinXShell4="QuickLaunch Icons",1,1,200,231,150,18,10,Bold
pButton_WinXShell4=HELP,1,8,430,230,70,20,HELPWinXShell4,0,True

[Interface4]
pButton_TAB_A="BBLean",1,8,5,0,80,25,Change.To.Tab.A,0,True,_Change.To.Tab.A,True
pButton_TAB_B="CMD",1,8,85,0,80,25,Change.To.Tab.B,0,True,_Change.To.Tab.B,True
pButton_TAB_C="WinXShell",1,8,165,0,80,25,Change.To.Tab.C,0,True,_Change.To.Tab.C,True
pTextLabel_TAB_D="LaunchBar",1,1,250,4,80,18,10,Bold
pButton_TAB_E="?",1,8,325,0,80,25,Change.To.Tab.E,0,True,_Change.To.Tab.E,True
pBevel_A1=,1,12,10,70,500,40
pScrollBox_A1=LaunchBar,1,4,20,80,100,20,LaunchBar
pTextLabel_A1=Current Shell,1,1,220,80,222,18,10,Bold
pButton_A1=HELP,1,8,430,80,70,20,HELPShell2,0,True,_HELPShell2_,True
pBevel_LaunchBar3=,1,12,10,120,500,40
pScrollBox_LaunchBar3=SMALL,1,4,20,130,100,20,SMALL,LARGE
pTextLabel_LaunchBar3=Icons,1,1,233,131,150,18,10,Bold
pButton_LaunchBar3=HELP,1,8,430,130,70,20,HELPLaunchBar3,0,True
pBevel_LaunchBar4=,1,12,10,170,500,40
pScrollBox_LaunchBar4=TOP,1,4,20,180,100,20,LEFT,RIGHT,TOP,BOTTOM
pTextLabel_LaunchBar4=Position,1,1,228,181,150,18,10,Bold
pButton_LaunchBar4=HELP,1,8,430,180,70,20,HELPLaunchBar4,0,True
pWebLabel_LaunchBar=http://www.lerup.com/LaunchBar/,1,10,150,45,180,18,http://www.lerup.com/LaunchBar/
pTextLabel_LaunchBar="LaunchBar Website",1,1,10,45,150,18,10,normal

[Change.To.Tab.A]
IniWrite,%ScriptFile%,Main,Interface,Interface1
System,REFRESHINTERFACE

[Change.To.Tab.B]
IniWrite,%ScriptFile%,Main,Interface,Interface2
System,REFRESHINTERFACE

[Change.To.Tab.C]
IniWrite,%ScriptFile%,Main,Interface,Interface3
System,REFRESHINTERFACE

[Change.To.Tab.D]
IniWrite,%ScriptFile%,Main,Interface,Interface4
System,REFRESHINTERFACE

[Change.To.Tab.E]
message,The shell in the selected tab will be used in the build. Change the tab to select a different shell.

[HELPBBLean2]
Message,"Enable bbLeanSkin plugin - this will apply a skin to all windows opened when the BBLean shell is running.#$x#$xSome programs may not function properly if skinned - if running Opera for example, the settings menu button will not be displayed/accessible."

[HELPShell]
Message,"Select one of the currently supported shells"

[HELPShell2]
Message,"This indicates which shell will be used in the build. Change by selecting a different shell in the #$qChange Shell To#$q option (see below)."

[HELPLaunchBar3]
Message,"Select the icon size. If all project options are enabled on a low resolution display then they may not be displayed correctly if LARGE icons are selected."

[HELPLaunchBar4]
Message,"Select LaunchBar screen position."

[HELPWinXShell2]
Message,"Enable to add Desktop Shortcuts to WinXShell. This option will override any 'Add to Desktop Menu' options set in other project scripts.#$x#$xAlthough the Desktop Shortcuts will automatically be created in a temp directory during the build process#$c they will not be added to the build unless this option is enabled."

[HELPWinXShell3]
Message,"Enable to add Start Menu Shortcuts to WinXShell. This option will override any 'Add to #$qStart#$q >' options set in other project scripts.#$x#$xAlthough the Start Menu Shortcuts will automatically be created in a temp directory during the build process#$c they will not be added to the build unless this option is enabled."

[HELPWinXShell4]
Message,"Enable to add Quick Launch Menu Shortcuts to WinXShell. This option will override any 'Add to Quicklaunch Menu' options set in other project scripts.#$x#$xAlthough the Quicklaunch Menu Shortcuts will automatically be created in a temp directory during the build process#$c they will not be added to the build unless this option is enabled."

[test]
If,%pScrollBox_A1%,Equal,BBLean,message,BBlean
If,%pScrollBox_A1%,Equal,CMD,message,BBlean
If,%pScrollBox_A1%,Equal,WinXShell,message,BBlean
If,%pScrollBox_A1%,Equal,LaunchBar,message,BBlean

[on_change]
If,%pScrollBox_Select%,Equal,BBLean,Begin
IniWrite,%ScriptFile%,Main,Interface,Interface1
System,REFRESHINTERFACE
End
If,%pScrollBox_Select%,Equal,CMD,Begin
IniWrite,%ScriptFile%,Main,Interface,Interface2
System,REFRESHINTERFACE
End
If,%pScrollBox_Select%,Equal,WinXShell,Begin
IniWrite,%ScriptFile%,Main,Interface,Interface3
System,REFRESHINTERFACE
End
If,%pScrollBox_Select%,Equal,LaunchBar,Begin
IniWrite,%ScriptFile%,Main,Interface,Interface4
System,REFRESHINTERFACE
End

[process]
If,%FullProjectRun%,Equal,NO,Run,"%ProjectDir%\Core\common.script",ExitScript
If,%pScrollBox_A1%,Equal,BBLean,Run,%ScriptFile%,BBLean
If,%pScrollBox_A1%,Equal,CMD,Set,%Shell%,CMD,Global
If,%pScrollBox_A1%,Equal,LaunchBar,Run,%ScriptFile%,LaunchBar
If,%pScrollBox_A1%,Equal,WinXShell,Run,%ScriptFile%,WinXShell
If,Not,ExistDir,"%ProjectTemp%\ShortCuts\Desktop",DirMake,"%ProjectTemp%\ShortCuts\Desktop"
If,Not,ExistDir,"%ProjectTemp%\ShortCuts\Quick",DirMake,"%ProjectTemp%\ShortCuts\Quick"
If,Not,ExistDir,"%ProjectTemp%\ShortCuts\Start",DirMake,"%ProjectTemp%\ShortCuts\Start"
If,Not,ExistDir,"%ProjectTemp%\ShortCuts\LaunchBar",DirMake,"%ProjectTemp%\ShortCuts\LaunchBar"
If,%Shell%,Equal,WinXShell,If,Not,ExistDir,"%ProjectTemp%\ShortCuts\Start\Programs",DirMake,"%ProjectTemp%\ShortCuts\Start\Programs"
IniWrite,"%OutputDir%\Project.Settings.ini",SHELL,Shell,%Shell%

[BBLean]
Set,%Shell%,BBLean,Global
If,Not,ExistFile,"%ProjectTemp%\programs.cmd.txt",FileCreateBlank,"%ProjectTemp%\programs.cmd.txt"
If,Not,ExistFile,"%ProjectTemp%\programs.rc.txt",FileCreateBlank,"%ProjectTemp%\programs.rc.txt"
DirMake,"%TargetDir%\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs"

[LaunchBar]
Set,%Shell%,LaunchBar,Global
If,ExistFile,"%ProjectTemp%\LaunchBar_Shell.ini",FileDelete,"%ProjectTemp%\LaunchBar_Shell.ini"
If,Not,ExistDir,"%TargetDir%\Programs",DirMake,"%TargetDir%\Programs"
If,Not,ExistDir,"%TargetDir%\Programs\LaunchBar_Shell",DirMake,"%TargetDir%\Programs\LaunchBar_Shell"
If,%ARCH%,Equal,x64,FileCopy,"%Programs%\LaunchBar\LaunchBar_x64.exe","%TargetDir%\Programs\LaunchBar_Shell"
If,%ARCH%,Equal,x86,FileCopy,"%Programs%\LaunchBar\LaunchBar.exe","%TargetDir%\Programs\LaunchBar_Shell"
If,Not,ExistDir,"%TargetDir%\Windows\System32\config\systemprofile\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch",DirMake,"%TargetDir%\Windows\System32\config\systemprofile\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch"
If,Not,ExistDir,"%ProjectTemp%\ShortCuts\Start",DirMake,"%ProjectTemp%\ShortCuts\Start"
ShellExecute,Hide,"%Tools%\Shortcut.exe","/A:C /T:#$q#$pSystemRoot#$p\System32\cmd.exe#$q /F:#$q%ProjectTemp%\cmd.lnk#$q"
If,ExistFile,"%ProjectTemp%\cmd.lnk",Begin
FileCopy,"%ProjectTemp%\cmd.lnk","%ProjectTemp%\ShortCuts\Start"
FileDelete,"%ProjectTemp%\cmd.lnk"
End
ShellExecute,Hide,"%Tools%\Shortcut.exe","/A:C /T:#$q#$pSystemRoot#$p\System32\rundll32.exe#$q /F:#$q%ProjectTemp%\run.lnk#$q /P:#$q#$pSystemRoot#$p\System32\shell32.dll#$c##61#$q /I:#$q#$pSystemRoot#$p\System32\shell32.dll#$c-25#$q"
If,ExistFile,"%ProjectTemp%\run.lnk",Begin
FileCopy,"%ProjectTemp%\run.lnk","%ProjectTemp%\ShortCuts\Start"
FileDelete,"%ProjectTemp%\run.lnk"
End

[WinXShell]
Set,%Shell%,WinXShell,Global
FileCopy,"%Programs%\WinXShell\%ARCH%\WinXShell.jcfg",%ProjectTemp%\WinXShell.txt
DirMake,"%TargetDir%\Users\Default\Desktop"
DirMake,"%TargetDir%\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs"
DirMake,"%TargetDir%\Users\Default\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch"
Set,%WinXShellIconsDesktop%,%pScrollBox_WinXShell2%,Global
Set,%WinXShellIconsMenu%,%pScrollBox_WinXShell3%,Global
Set,%WinXShellIconsQuickLaunch%,%pScrollBox_WinXShell4%,Global
If,Not,ExistDir,"%TargetDir%\Programs",DirMake,"%TargetDir%\Programs"
DirMake,"%TargetDir%\Programs\WinXShell"
DirCopy,"%Programs%\WinXShell\%ARCH%\*.*","%TargetDir%\Programs\WinXShell"
IniWrite,"%OutputDir%\Project.Settings.ini",SHELL,WinXShellIconsDesktop,%WinXShellIconsDesktop%
IniWrite,"%OutputDir%\Project.Settings.ini",SHELL,WinXShellIconsMenu,%WinXShellIconsMenu%
IniWrite,"%OutputDir%\Project.Settings.ini",SHELL,WinXShellIconsQuickLaunch,%WinXShellIconsQuickLaunch%

[AuthorEncoded]
Logo=donut.ico
donut.ico=953,1271

[EncodedFile-AuthorEncoded-donut.ico]
lines=0
0=eJztmctKI0EUhiu2kkXUaAKDN3AWMzAgShARESUgbly4UBQEBUfxhqgENwoBM270Fdy4EBEHXYjgwoWXRvHyAOpKMI+QpQvxTP4kxWQ6Gbu6ujvdSBL+/NAdzvlOpet0V4UxT/IdCrHk51f2+ztjXxhjP5JKHmI/Wfp46vWNsYAvLf4ioqKKKsqkjo+PKRKJUGdnJwWDQdKer66upvb2dpqbm6O9vb2c807o6emJpqamqLKyktAKsqX9rvZ8WVkZ9ff30+npqSO1jI6OksfjyeEW5c8Wfperq6uC1LG9vU3l5eX/ZZHhhzAWs7OzttYwPj6uyy3Lz9XS0kIvLy+W19HT0yPMboYfqquro8fHR8tq6O3tNcRulh+qr6+3hH9mZsYwuxX8UCgUMlXD/v6+FLtV/NDi4qJ0DYFAwHH+kpISur+/N1zD/Py8NLuV/FB3d7dhftwf3cIPXV5eCtewurpqKpcd/MPDw8L8DQ0NruP3er1C/Hd3d6byKIpCCwsLObmi0Sj5/X5TsQ8PD3Vr2NzclI4PPlVVP8zR3NwsHV+klw4ODkrFRp87OzvTjR+Px6miokIqR0dHh278pqYmqdh4thOdX2tra1I5cD/Si411kkzsm5sbYX47Jdv3neb+LPyy18/t7a0rapCdvxMTE8L8sVjMtvk7MDAgFRv9U6/3c+XbrxCRSP/c2NiQig3h2tO7jrAmkY2f776uFfLLxocw/5eXl3PyrK+vk5n1BHRwcCD0+2LtaSYPpI1pNp7o8xu0srLiOv6hoSFD/a20tNRV/BcXF4b4sc/qFv6uri5D7FxVVVWO82NfUfbeuLu76zg/9hFk2LkmJycd48deqBl2LqN7n1bw19bWEtY6VvBD4XC4YPw1NTX08PBgGTvX2NiY7fx4fnx+fracnWtra4t8Pp8t/JhrdnFrNTIyYtn/R62trXR+fl4wdi5coxizfP8n6fFjn6ivr49OTk4Kzp1PR0dHtLS0lHpGz7fOwL2wra2NpqenaWdnxxXMRRX1CQT7wK+vU/6uqDH4m6I2whOKit1kiiuqAlcVFd2UfmWcKSo6zTs8lvEwY2/Z3sjYq8YTcD/cm0i7P+ONrxlPcSVYWOP8OP+e//XfOOm42nxv2R7+y8m5eR2oi2XXyevm48DHhY8THzed8f0DAAkXr3ic40zJzyst0ctMzmcYBSMQ7FOF0AXM2OXvezWmMTABAOsJBwX2TQ3DAQAAAAIAAAAlAAAAcAMAAAAAAAABAAAAAAAAAAAAAAA

